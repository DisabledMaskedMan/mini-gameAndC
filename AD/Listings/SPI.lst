C51 COMPILER V9.54   SPI                                                                   04/05/2023 22:28:30 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE SPI
OBJECT MODULE PLACED IN .\Objects\SPI.obj
COMPILER INVOKED BY: D:\51one-chip computer\C51\BIN\C51.EXE SPI.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Li
                    -stings\SPI.lst) OBJECT(.\Objects\SPI.obj)

line level    source

   1          #include <REGX52.H>
   2          
   3          sbit AD_CS = P3^5;
   4          sbit AD_DIN = P3^4;
   5          sbit AD_DCLK = P3^6;
   6          sbit AD_DOUT = P3^7;
   7          
   8          /**
   9            * @brief  ZPT2046读取AD值
  10            * @param  Command 命令字，范围：头文件内定义的宏，结尾的数字表示转换的位数
  11            * @retval AD转换后的数字量，范围：8位为0~255，12位为0~4095
  12            */
  13          unsigned int SPI_READ(unsigned char command)
  14          {
  15   1              unsigned char i;
  16   1              unsigned int Data = 0x00;
  17   1              AD_CS = 1;
  18   1              AD_DCLK = 0;
  19   1              AD_CS = 0;
  20   1              for(i = 0; i < 8; i++)
  21   1              {
  22   2                      AD_DIN = command & (0x80 >> i);
  23   2                      AD_DCLK = 1;
  24   2                      AD_DCLK = 0;
  25   2              }
  26   1              for(i = 0; i < 16; i++)
  27   1              {
  28   2                      AD_DCLK = 1;
  29   2                      AD_DCLK = 0;
  30   2                      if(AD_DOUT)
  31   2                              Data |= (0x8000 >> i);
  32   2              }
  33   1              AD_CS = 1;
  34   1              return Data >> 8;
  35   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     91    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
