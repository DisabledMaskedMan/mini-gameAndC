C51 COMPILER V9.54   MAIN                                                                  03/31/2023 23:34:39 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\51one-chip computer\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\L
                    -istings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "AT24C02.h"
   3          #include "timer0.h"
   4          #include "Nixie.h"
   5          #include "delay.h"
   6          #include "Key.h"
   7          
   8          unsigned char KeyNum;
   9          unsigned char minute,second,minisec;
  10          unsigned char timeflag;
  11          
  12          void main()
  13          {
  14   1              Timer0_Init();
  15   1              
  16   1              while(1)
  17   1              {
  18   2                      KeyNum = key();
  19   2                      if(KeyNum == 1)
  20   2                              timeflag = !timeflag;
  21   2                      if(KeyNum == 2)
  22   2                      {
  23   3                              minute = 0;
  24   3                              second = 0;
  25   3                              minisec = 0;
  26   3                      }
  27   2                      if(KeyNum == 3)
  28   2                      {
  29   3                              AT24C02_Write(0, minute);
  30   3                              delay(5);
  31   3                              AT24C02_Write(1, second);
  32   3                              delay(5);
  33   3                              AT24C02_Write(2, minisec);
  34   3                              delay(5);
  35   3                      }
  36   2                      if(KeyNum == 4)
  37   2                      {
  38   3                              minute = AT24C02_Read(0);
  39   3                              second = AT24C02_Read(1);
  40   3                              minisec = AT24C02_Read(2);
  41   3                      }
  42   2                      Nixie_SetBuf(1, minute / 10);
  43   2                      Nixie_SetBuf(2, minute % 10);
  44   2                      Nixie_SetBuf(3, 11);
  45   2                      Nixie_SetBuf(4, second / 10);
  46   2                      Nixie_SetBuf(5, second % 10);
  47   2                      Nixie_SetBuf(6, 11);
  48   2                      Nixie_SetBuf(7, minisec / 10);
  49   2                      Nixie_SetBuf(8, minisec % 10);
  50   2              }
  51   1      }
  52          
  53          void SecLoop()
  54          {
C51 COMPILER V9.54   MAIN                                                                  03/31/2023 23:34:39 PAGE 2   

  55   1              if(timeflag)
  56   1              {
  57   2                      minisec++;
  58   2                      if(minisec > 99)
  59   2                      {
  60   3                              second++;
  61   3                              minisec = 0;
  62   3                              if(second > 59)
  63   3                              {
  64   4                                      second = 0;
  65   4                                      minute++;
  66   4                                      if(minute > 59)
  67   4                                              minute = 0;
  68   4                              }
  69   3                      }
  70   2              }
  71   1              
  72   1      }
  73          
  74          void Timer0_Rountine() interrupt 1
  75          {
  76   1              static unsigned int count1, count2, count3;
  77   1              TL0 = 0x66;
  78   1              TH0 = 0xFC;
  79   1              count1++;
  80   1              if(count1 == 20)
  81   1              {
  82   2                      count1 = 0;
  83   2                      KeyLoop();
  84   2              }
  85   1              count2++;
  86   1              if(count2 == 2)
  87   1              {
  88   2                      count2 = 0;
  89   2                      Nixie_Loop();
  90   2              }
  91   1              count3++;
  92   1              if(count3 == 10)
  93   1              {
  94   2                      count3 = 0;
  95   2                      SecLoop();
  96   2              }
  97   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    387    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     11    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
