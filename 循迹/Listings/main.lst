C51 COMPILER V9.54   MAIN                                                                  04/15/2023 23:21:48 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\51one-chip computer\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\L
                    -istings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.H>
   2          #include <timer0.h>
   3          #include <CarRun.h>
   4          #include <delay.h>
   5          
   6          sbit ENA = P0^0;
   7          sbit ENB = P0^5;
   8          sbit ENA2 = P1^0;
   9          sbit ENB2 = P1^5;
  10          
  11          sbit AOB = P0^6;                //E18D80Nk
  12          
  13          
  14          sbit PML1 = P2^0;               //左光敏
  15          sbit PML2 = P2^1;
  16          sbit PML3 = P2^2;
  17          sbit PML4 = P2^3;
  18          
  19          
  20          sbit PMR1 = P3^4;               //右光敏
  21          sbit PMR2 = P3^5;
  22          sbit PMR3 = P3^6;
  23          sbit PMR4 = P3^7;
  24          
  25          unsigned char pwm_right, pwm_left;
  26          unsigned char pwm_right_time, pwm_left_time;
  27          unsigned char n = 3;
  28          
  29          
  30          void main()
  31          {
  32   1              Timer0_Init();
  33   1              pwm_right = 25;
  34   1              pwm_left = 25;
  35   1              while(1)
  36   1              {
  37   2                      if(PML3 == 0 && PML4 == 1 && PMR1 == 1 && PMR2 == 1 && PMR3 == 1)
  38   2                      {
  39   3                              pwm_right = 15;
  40   3                              pwm_right_time =15;
  41   3                              pwm_left = 25;
  42   3                              pwm_left_time = 25;
  43   3                              while(!(PML1 == 0 && PML2 == 0 && PML3 == 1 && PML4 == 1 
  44   3                                      && PMR1 == 1 && PMR2 == 1 && PMR3 == 0 && PMR4 == 0))
  45   3                              {
  46   4                                      
  47   4                              }
  48   3                      }
  49   2                      
  50   2                      if(PML2 == 1 && PML3 == 1 && PML4 == 1 && PMR1 == 1 && PMR2 == 0)
  51   2                      {
  52   3                              pwm_right = 25;
  53   3                              pwm_right_time = 25;
  54   3                              pwm_left = 15;
C51 COMPILER V9.54   MAIN                                                                  04/15/2023 23:21:48 PAGE 2   

  55   3                              pwm_left_time = 15;
  56   3                              while(!(PML1 == 0 && PML2 == 0 && PML3 == 1 && PML4 == 1 
  57   3                                      && PMR1 == 1 && PMR2 == 1 && PMR3 == 0 && PMR4 == 0))
  58   3                              {
  59   4                                      
  60   4                              }
  61   3                      }
  62   2                      
  63   2                      if(PML1 == 1 && PML2 == 1 && PML3 == 1 && PML4 == 1)
  64   2                      {
  65   3                              pwm_right = 25;
  66   3                              pwm_right_time = 25;
  67   3                              pwm_left = 5;
  68   3                              pwm_left_time = 5;
  69   3                              while(!(PML1 == 0 && PML2 == 0 && PML3 == 1 && PML4 == 1 
  70   3                                      && PMR1 == 1 && PMR2 == 1 && PMR3 == 0 && PMR4 == 0))
  71   3                              {
  72   4                                      
  73   4                              }
  74   3                      }
  75   2                      
  76   2                      if(PMR1 == 1 && PMR2 == 1 && PMR3 == 1 && PMR4 == 1)
  77   2                      {
  78   3                              pwm_right = 5;
  79   3                              pwm_right_time =5;
  80   3                              pwm_left = 25;
  81   3                              pwm_left_time = 25;
  82   3                              while(!(PML1 == 0 && PML2 == 0 && PML3 == 1 && PML4 == 1 
  83   3                                      && PMR1 == 1 && PMR2 == 1 && PMR3 == 0 && PMR4 == 0))
  84   3                              {
  85   4                                      
  86   4                              }
  87   3                      }
  88   2                      
  89   2                      if(PML3 == 1 && PML4 == 1 && PMR1 == 1 && PMR2 == 1 && PMR3 == 1 && PMR4 == 1)
  90   2                      {
  91   3                              CarStop();
  92   3                              delay(100);
  93   3                              CarRight();
  94   3                      }
  95   2                      
  96   2                      if(PML1 == 1 && PML2 == 1 && PML3 == 1 && PML4 == 1 && PMR1 == 1 && PMR2 == 1)
  97   2                      {
  98   3                              CarStop();
  99   3                              delay(100);
 100   3                              CarLeft();
 101   3                      }
 102   2                      
 103   2                      if(PML1 == 1 && PML2 == 1 && PML3 == 1 && PML4 == 1 
 104   2                              && PMR1 == 1 && PMR2 == 1 && PMR3 == 1 && PMR4 == 1)
 105   2                      {
 106   3                              delay(100);
 107   3                              if(PML1 == 0 && PML2 == 0 && PML3 == 0 && PML4 == 0 
 108   3                                      && PMR1 == 0 && PMR2 == 0 && PMR3 == 0 && PMR4 == 0)
 109   3                              {
 110   4                                      CarStop();
 111   4                                      delay(2000);
 112   4                                      n--;
 113   4                                      if(n == 0)
 114   4                                      {
 115   5                                              while(1)
 116   5                                              {
C51 COMPILER V9.54   MAIN                                                                  04/15/2023 23:21:48 PAGE 3   

 117   6                                                      
 118   6                                              }
 119   5                                      }
 120   4                              }
 121   3                      }
 122   2                      
 123   2                      if(AOB == 0)
 124   2                      {
 125   3                              Car_Left_Shift();
 126   3                              pwm_right = 25;
 127   3                              pwm_right_time = 25;
 128   3                              delay(500);
 129   3                              
 130   3                              Car_Right_Shift();
 131   3                              pwm_left = 25;
 132   3                              pwm_left_time = 25;
 133   3                              while(!(PML1 == 0 && PML2 == 0 && PML3 == 1 && PML4 == 1 
 134   3                                      && PMR1 == 1 && PMR2 == 1 && PMR3 == 0 && PMR4 == 0))
 135   3                              {
 136   4                                      
 137   4                              }
 138   3                              CarGo();
 139   3                              pwm_left = 25;
 140   3                              pwm_left_time = 25;
 141   3                              pwm_right = 25;
 142   3                              pwm_right_time = 25;
 143   3                              
 144   3                      }
 145   2                      
 146   2                      
 147   2              }
 148   1      }
 149          
 150          void Timer0_Rountine() interrupt 1
 151          {
 152   1              static unsigned int count;
 153   1              TL0 = 0xD7;
 154   1              TH0 = 0xFD;
 155   1              count++;
 156   1              if(count == 100)
 157   1              {
 158   2                      count = 0;
 159   2                      pwm_right_time++;
 160   2                      if(pwm_right_time > pwm_right)
 161   2                              pwm_right_time = pwm_right;
 162   2                      pwm_left_time++;
 163   2                      if(pwm_left_time > pwm_left)
 164   2                              pwm_left_time = pwm_left;
 165   2              }
 166   1              if(count >= pwm_right_time)
 167   1              {
 168   2                      ENA = 0;
 169   2                      ENA2 = 0;
 170   2              }
 171   1              if(count >= pwm_left_time)
 172   1              {
 173   2                      ENB = 0;
 174   2                      ENB2 = 0;
 175   2              }
 176   1              if(count < pwm_right_time)
 177   1              {
 178   2                      ENA = 1;
C51 COMPILER V9.54   MAIN                                                                  04/15/2023 23:21:48 PAGE 4   

 179   2                      ENA2 = 1;
 180   2              }
 181   1              if(count < pwm_left_time)
 182   1              {
 183   2                      ENB = 1;
 184   2                      ENB2 = 1;
 185   2              }
 186   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    548    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      7    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
